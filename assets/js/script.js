// Generated by CoffeeScript 2.0.0
//http://www.mattvanandel.com/999/jquery-nextorfirst-function-guarantees-a-selection/
var change_slogan, draw, spinner, video_mobile;

jQuery.fn.nextOrFirst = function(selector) {
  var next;
  next = this.next(selector);
  if (next.length) {
    return next;
  } else {
    return this.prevAll(selector).last();
  }
};

jQuery.fn.prevOrLast = function(selector) {
  var prev;
  prev = this.prev(selector);
  if (prev.length) {
    return prev;
  } else {
    return this.nextAll(selector).last();
  }
};

video_mobile = function() {
  if (jQuery(window).width() < 769) {
    jQuery('.fixed_box').removeClass('affix');
    jQuery('.widget_yt_widget .fixed_box').width(jQuery('.widget').parent().width() + 30);
    return jQuery('.widget_yt_widget').detach().appendTo('.entry-content');
  }
};

//http://thecodeplayer.com/walkthrough/matrix-rain-animation-html5-canvas-javascript
spinner = function() {
  var columns, o, x;
  o = document.querySelector(".c");
  //making the canvas full screen
  o.height = window.innerHeight;
  o.width = window.innerWidth;
  //Hide show the page/canvas
  o.style.display = "block";
  document.querySelector(".wrapper").style.display = "none";
  document.querySelector(".backstretch").style.display = "none";
  columns = o.width / window.o_font_size; //number of columns for the rain
  //an array of drops - one per column
  window.o_drops = [];
  //x below is the x coordinate
  //1 = y co-ordinate of the drop(same for every drop initially)
  x = 0;
  while (x < columns) {
    window.o_drops[x] = 1;
    x++;
  }
  window.o_kill = setInterval(draw, 33);
};

//drawing the characters
draw = function() {
  var ctx, i, o, text;
  if (document.querySelector(".c") !== null) {
    o = document.querySelector(".c");
    ctx = o.getContext("2d");
    //Black BG for the canvas
    //translucent BG to show trail
    ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
    ctx.fillRect(0, 0, o.width, o.height);
    ctx.fillStyle = "#0F0"; //green text
    ctx.font = window.o_font_size + "px arial";
    //looping over drops
    i = 0;
    while (i < window.o_drops.length) {
      //a random chinese character to print
      text = window.o_chinese[Math.floor(Math.random() * window.o_chinese.length)];
      //x = i*font_size, y = value of drops[i]*font_size
      ctx.fillText(text, i * window.o_font_size, window.o_drops[i] * window.o_font_size);
      if (window.o_drops[i] * window.o_font_size > o.height && Math.random() > 0.975) {
        //sending the drop back to the top randomly after it has crossed the screen
        //adding a randomness to the reset to make the drops scattered on the Y axis
        window.o_drops[i] = 0;
      }
      //incrementing Y coordinate
      window.o_drops[i]++;
      i++;
    }
  }
};

document.addEventListener('DOMContentLoaded', function(event) {
  return document.querySelector("#copy").addEventListener("click", function() {
    var m, o;
    if (document.querySelector(".c") === null) {
      o = document.createElement("canvas");
      o.classList.add("c");
      document.body.appendChild(o);
      window.o_font_size = 10;
      m = document.createElement("div");
      m.classList.add("d");
      m.textContent = "Welcome to Canvas Matrix, Neo";
      document.body.appendChild(m);
      //chinese characters - taken from the unicode charset
      window.o_chinese = "田由甲申甴电甶男甸甹町画甼甽甾甿畀畁畂畃畄畅畆畇畈畉畊畋界畍畎畏畐畑";
      //converting the string into an array of single characters
      window.o_chinese = window.o_chinese.split("");
    }
    spinner();
  }, false);
});

window.onkeydown = function(e) {
  if (e.keyCode === 27) {
    document.querySelector(".c").remove();
    document.querySelector(".d").remove();
    clearInterval(window.o_kill);
    document.querySelector(".wrapper").style.display = "block";
    document.querySelector(".backstretch").style.display = "block";
  }
};

jQuery('.news .arrow.fa-angle-up').click(function() {
  return jQuery(".news ul.box-carousel > li:visible").hide().prevOrLast().slideDown("fast");
});

jQuery('.news .arrow.fa-angle-down').click(function() {
  return jQuery(".news ul.box-carousel > li:visible").hide().nextOrFirst().slideDown("fast");
});

jQuery('.guest-post .arrow.fa-angle-up').click(function() {
  return jQuery(".guest-post ul.box-carousel > li:visible").hide().prevOrLast().slideDown("fast");
});

jQuery('.guest-post .arrow.fa-angle-down').click(function() {
  return jQuery(".guest-post ul.box-carousel > li:visible").hide().nextOrFirst().slideDown("fast");
});

jQuery('.last-events .arrow').click(function() {
  return jQuery(".last-events .first-block").slideToggle();
});

change_slogan = function() {
  return jQuery(".slogan ul li:visible").hide().nextOrFirst().css("display", "inline");
};

setInterval(change_slogan, 2000);

jQuery('.slogan').flowtype({
  minimum: 400,
  maximum: 1200,
  minFont: 13,
  maxFont: 40
});

jQuery('.last-events').flowtype({
  minimum: 300,
  maximum: 1200,
  minFont: 12,
  maxFont: 20
});

if (jQuery(window).width() > 769) {
  jQuery('.main').css('min-height', jQuery('aside').height() + 20);
}

jQuery('body').backstretch('/wp-content/themes/mte90-2014/assets/img/background.jpg');

// jQuery('.widget_yt_widget .fixed_box').width((jQuery('.widget').parent().width() + 30))
video_mobile();

jQuery(window).resize(function() {
  return video_mobile();
});

jQuery('.main article .entry-content a').has("img").css({
  transform: "none",
  display: "block"
});

jQuery('.main article .entry-content img').each(function(index) {
  if (jQuery(this).attr('width') < 500) {
    return jQuery(this).css({
      'width': 'auto'
    });
  }
});

jQuery(".social-facebook,.social-linkedin").click(function(e) {
  var link;
  link = this;
  e.preventDefault();
  e.stopPropagation();
  return jQuery("html").animate({
    scrollTop: 0
  }, "fast", function() {
    return bootbox.alert(jQuery(link).data('text') + '<br><br>' + '<a href="' + jQuery(link).attr('href') + '">' + jQuery(link).attr('href') + '</a>');
  });
});

jQuery(".social-feed").click(function(e) {
  var link;
  link = this;
  e.preventDefault();
  e.stopPropagation();
  return jQuery("html").animate({
    scrollTop: 0
  }, "fast", function() {
    return bootbox.alert(jQuery(link).data('text'));
  });
});

//# sourceMappingURL=script.js.map
